# Project Description

First time running a genomics online CURE.  We tested range of trimming parameters trimq and minlen in software bbduk on sex differences in gene expression seen in batch 1 of the Yale placenta data set (Olney et al, Sex differences in early and term placenta are conserved in adult tissues, Biol Sex Differ
. 2022 Dec 22;13(1):74. doi: 10.1186/s13293-022-00470-y)

This was the pilot run of the asynchronous online genomics CURE with a total of 13 students who consented to and finished the entire course.  In this course, we developed the overall framework of how we would teach online biology students from all around the world who have very little programming experience what is involved in computational genomics research.  At the heart of this course was that we wanted to show the students what it is like to do research in a real computational genomics research lab as closely as we could.  We wanted to create an environment where students had a way to reach out to each other even if they didn't work during usual business hours or if they were living in another country or if their work time was interrupted by other responsibilities.  We wanted to create an environment where the students would gain important and marketable skills, mentorship, and community while doing actually doing the analysis to address a research question.  

The research project at the center of this course investigated the effect of data processing methods on identification of sex differences in gene expression in human placenta. In a previously published study (Olney et al. 2022), the instructors of this CURE identified genes that were differentially expressed between male and female placentas from full-term pregnancies using a well-established analysis workflow: trimming of low quality RNA sequencing reads and the limma-voom pipeline for differentially expression of genes between two groups (males and females; https://github.com/SexChrLab/Placenta_Sex_Diff). The parameters chosen for trimming adapter sequences and low-quality RNA sequencing reads were determined using experiences of the lead investigators of the study, but literature review showed a variety of thresholds for what was considered to be low quality for reads. This led to the research question of how robust the published sex differential gene expression profile was to changes in trimming parameters. Literature on the effect of changing thresholds for trimming on differential gene expression is both limited and contradictory (Williams et al. 2016; Liao and Shi 2020; Macmanes 2014; Del Fabbro et al. 2013), so the instructors devised a course that would allow students to test a range of values for the ‘trimq’ and ‘minlen’ trimming parameters implemented in bbduk, the software used in the original manuscript, to test whether and how the sex differential expression profile was affected in the placenta tissues. All of the required background knowledge for this project and project aims were presented to students in the first learning module of the course.For our research project, we performed data processing before the course started so that they could spend the first two modules learning the required conceptual background material to understand the research project and learn basic programming techniques needed to run differential expression analysis and data visualization. In Module 3, all students were assigned to run the differential gene expression pipeline on the raw data with no quality trimming applied. In doing this, they were able to learn how to use the code, modify it where necessary, and ask questions from their instructors and peers if they ran into any problems. For Module 4, we assigned data trimmed with specific trimming parameters to pairs of students to analyze using the same code they worked with all together with the untrimmed data. Instructors paired the students so that they would have a way to double check that someone else got the same results they did and could have someone to work with if they desired or could just as easily work independently. The decision about whether to work in a group or individually was up to the student, and intended as an inclusive teaching strategy given time zone differences and the difficulty of doing group work asynchronously. In this way, we distributed the analysis equally among the students and simultaneously built in redundancy to make the research goals more robust to students having problems or dropping out of the course. Once the students had performed differential expression analysis, we had them each compare their results to those attained with the untrimmed data. At the end of Module 4, we asked that they turn in their code, differential gene expression profile, and results of the two-way comparison as a graded assignment. The instructors then checked for errors and put all the results in a central online location so that the entire class could access it. Then for Module 5, the students were able to use all the results generated by the entire class to compare results across the full trimming parameter range to determine trends in how trimming parameters affected differential gene expression. With access to the fully analyzed data set, each student was asked to present results in the format of a scientific manuscript and peer review manuscripts written by classmates.


# Directory structure

## data_generation

Contains all snakefiles used to generate and process trimmed data so it can be passed into differential expression pipeline.

## cluster_submission

Contains sbatch scripts used to run snakefiles on ASU Agave biocomputing cluster

## Differential_Expression

Contains Rmd files of the limma-voom differential expression pipeline, modified to run analysis for the CURE.  This includes code to do pairwise comparison of two differentially expressed gene lists and an upset comparing the entire range of data sets.
